# Contributor: Rasmus Thomsen <oss@cogitri.dev>
# Maintainer: Rasmus Thomsen <oss@cogitri.dev>
pkgname=alpinelinux-appstream-data
pkgver=20200910
pkgrel=0
pkgdesc="Alpine Linux appstream data"
url="https://alpinelinux.org"
arch="x86_64 aarch64" # Only arches metadata is generated for
license="GPL-3.0-or-later"
options="!check" # Only XML data and icons - no tests
# Make sure to replace v3.12 with the appropriate branch when updating
source="
	$pkgname-icons-main-64x64-$pkgver-v3.12.tar.gz::https://appstream.alpinelinux.org/$pkgver/data/v3.12/main/icons-64x64.tar.gz
	$pkgname-icons-main-128x128-$pkgver-v3.12.tar.gz::https://appstream.alpinelinux.org/$pkgver/data/v3.12/main/icons-128x128.tar.gz
	$pkgname-repo-main-x86_64-$pkgver-v3.12.xml.gz::https://appstream.alpinelinux.org/$pkgver/data/v3.12/main/Components-x86_64.xml.gz
	$pkgname-repo-main-aarch64-$pkgver-v3.12.xml.gz::https://appstream.alpinelinux.org/$pkgver/data/v3.12/main/Components-aarch64.xml.gz
	$pkgname-icons-community-64x64-$pkgver-v3.12.tar.gz::https://appstream.alpinelinux.org/$pkgver/data/v3.12/community/icons-64x64.tar.gz
	$pkgname-icons-community-128x128-$pkgver-v3.12.tar.gz::https://appstream.alpinelinux.org/$pkgver/data/v3.12/community/icons-128x128.tar.gz
	$pkgname-repo-community-x86_64-$pkgver-v3.12.xml.gz::https://appstream.alpinelinux.org/$pkgver/data/v3.12/community/Components-x86_64.xml.gz
	$pkgname-repo-community-aarch64-$pkgver-v3.12.xml.gz::https://appstream.alpinelinux.org/$pkgver/data/v3.12/community/Components-aarch64.xml.gz
"
builddir="$srcdir/"

unpack() {
	:
}

package() {
	mkdir -p "$pkgdir"/usr/share/app-info/xmls

	for _repo in main community; do
		mkdir -p \
		"$pkgdir"/usr/share/app-info/icons/alpinelinux-v3.12-$_repo/64x64 \
			"$pkgdir"/usr/share/app-info/icons/alpinelinux-v3.12-$_repo/128x128

			tar xf "$srcdir"/$pkgname-icons-$_repo-64x64-$pkgver-v3.12.tar.gz -C "$pkgdir"/usr/share/app-info/icons/alpinelinux-v3.12-$_repo/64x64
		tar xf "$srcdir"/$pkgname-icons-$_repo-128x128-$pkgver-v3.12.tar.gz -C "$pkgdir"/usr/share/app-info/icons/alpinelinux-v3.12-$_repo/128x128
		cp "$srcdir"/$pkgname-repo-$_repo-$CARCH-$pkgver-v3.12.xml.gz "$pkgdir"/usr/share/app-info/xmls/$_repo.xml.gz
	done
}

sha512sums="61629fb06472b2fcf48af9965769834cb704b3f5897b63d9b55052512b8bf839066b2647b1923c14dd2ab07ac5de9270b167966ee4dd93a44f944a4f9d807a44  alpinelinux-appstream-data-icons-main-64x64-20200910-v3.12.tar.gz
61629fb06472b2fcf48af9965769834cb704b3f5897b63d9b55052512b8bf839066b2647b1923c14dd2ab07ac5de9270b167966ee4dd93a44f944a4f9d807a44  alpinelinux-appstream-data-icons-main-128x128-20200910-v3.12.tar.gz
6a4b8a8577bede75b335876612746c71be51029b7ab11faea5eaf87efd4aeffb0ddb16b2918204fdd35fa7b7d85c4a7db8fef604a0c3e2e3b26e727d2b488c6f  alpinelinux-appstream-data-repo-main-x86_64-20200910-v3.12.xml.gz
608e37ff2717b914a5034947c7a5f2d2921b388d0e38f2a7f08d9957d915a550754f624eff2a07f3263f80e063d51c553e4e882661651d6d35d14db05d85649a  alpinelinux-appstream-data-repo-main-aarch64-20200910-v3.12.xml.gz
7306b334353e4a34cf73a7ec06c8b660a8790fa8bc43af81bc0a7b10c2970afebe6d340797166ea4ff72b6d3c8d36f58362895a4848a2fe283986caaef0019e0  alpinelinux-appstream-data-icons-community-64x64-20200910-v3.12.tar.gz
2644f1a9a02b2690a7e44f70e1108621c58eb3f8d7b780a076425eeb0ff1b04e5c280e184980f59dec807eb0fb8ffcccb9275e9a1fc3a16b697d6168c1caa468  alpinelinux-appstream-data-icons-community-128x128-20200910-v3.12.tar.gz
47ca9cecd1943d907dd63f30b6fa3fdab62361e3d6ae83dc428ea8ea0ab15be9491abaca0777798775e286abedb92325ce8ebe890aa50691b2916c012c8fb3a3  alpinelinux-appstream-data-repo-community-x86_64-20200910-v3.12.xml.gz
41b7f9abcf9fce617d388058196596a0231e623f1fa8fdaa858cd062d60d6de8c82b5ca7541ea5e15c53a9f23b5a0458fa620198cce45943f2e9ad534ac91363  alpinelinux-appstream-data-repo-community-aarch64-20200910-v3.12.xml.gz"
